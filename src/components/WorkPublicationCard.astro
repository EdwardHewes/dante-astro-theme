---
interface Props {
    publicationName: string;
    publicationUrl?: string;
    publicationDescription?: string;
    articles: Array<{
        id?: string;
        title: string;
        description?: string;
        publishDate?: Date | string;
        url?: string;
    }>;
}

const { publicationName, publicationUrl, publicationDescription, articles } = Astro.props;
---

<div class="publication-group mb-16 border-b border-gray-200 pb-16 last:border-b-0 last:mb-0 last:pb-0 dark:border-gray-800 lg:flex lg:gap-8 lg:mb-20 lg:pb-20">
    <!-- Left Column: Publication/Client Name -->
    <div class="lg:w-1/4 lg:flex-shrink-0 mb-8 lg:mb-0">
        {publicationUrl ? (
            <a 
                href={publicationUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-block group"
            >
                <h3 class="font-serif text-lg font-semibold text-gray-900 dark:text-white group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2 transition-all">
                    {publicationName}
                </h3>
            </a>
        ) : (
            <h3 class="font-serif text-lg font-semibold text-gray-900 dark:text-white">
                {publicationName}
            </h3>
        )}
    </div>

    <!-- Right Column: Articles/Projects List -->
    <div class="lg:w-3/4 lg:flex-1">
        {publicationDescription && (
            <p class="mb-6 text-sm text-gray-600 dark:text-gray-400">
                {publicationDescription}
            </p>
        )}
        <div class="relative">
            <div class="space-y-8 max-h-64 overflow-y-auto scroll-smooth pr-4 lg:pr-8" tabindex="0">
                {articles.map((article) => (
                    <div class="article-entry">
                    {article.url ? (
                        <a
                            href={article.url}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="block group"
                        >
                            <h4 class="font-serif text-base font-semibold text-gray-900 dark:text-white group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2 transition-all">
                                {article.title}
                            </h4>
                        </a>
                    ) : article.id ? (
                        <a
                            href={`/work/${article.id}/`}
                            class="block group"
                        >
                            <h4 class="font-serif text-base font-semibold text-gray-900 dark:text-white group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2 transition-all">
                                {article.title}
                            </h4>
                        </a>
                    ) : (
                        <h4 class="font-serif text-base font-semibold text-gray-900 dark:text-white">
                            {article.title}
                        </h4>
                    )}
                    
                    {article.description && (
                        <p class="mt-1 text-sm text-gray-600 dark:text-gray-400 italic">
                            {article.description}
                        </p>
                    )}
                    
                    {article.publishDate && (
                        <p class="mt-2 text-xs text-gray-500 dark:text-gray-500 font-sans">
                            {typeof article.publishDate === 'string' 
                                ? article.publishDate
                                : new Intl.DateTimeFormat('en-US', { 
                                    year: 'numeric', 
                                    month: 'short', 
                                    day: 'numeric' 
                                }).format(article.publishDate)
                            }
                        </p>
                    )}
                </div>
            ))}
            </div>

            {/* Fade gradient indicator at bottom to show more content */}
            {articles.length > 5 && (
                <div class="pointer-events-none absolute inset-x-0 bottom-0 h-10">
                    <div class="h-full bg-gradient-to-b from-transparent to-white dark:to-[#0b0b0b] opacity-90"></div>
                </div>
            )}

            {articles.length === 0 && (
                <p class="text-gray-500 dark:text-gray-400 italic text-sm mt-2">
                    No articles yet.
                </p>
            )}
        </div>
    </div>
</div>

<style>
    .publication-group {
        scroll-margin-top: 2rem;
    }

    @media (min-width: 1024px) {
        .publication-group {
            scroll-margin-top: 4rem;
        }
    }

    /* Subtle custom scrollbar styling */
    /* More visible scrollbar for the articles container */
    .publication-group .max-h-48::-webkit-scrollbar {
        width: 14px;
    }

    .publication-group .max-h-48::-webkit-scrollbar-thumb {
        background: rgba(0,0,0,0.22);
        border-radius: 9999px;
        border: 3px solid rgba(255,255,255,0.0);
        background-clip: padding-box;
    }

    .publication-group .max-h-48::-webkit-scrollbar-track {
        background: rgba(0,0,0,0.04);
        border-radius: 9999px;
    }

    .publication-group .max-h-48 {
        scrollbar-width: auto;
        scrollbar-color: rgba(0,0,0,0.22) rgba(0,0,0,0.04);
    }
</style>
